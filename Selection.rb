#==============================================================================
# ** Viewport
#------------------------------------------------------------------------------
# 
#==============================================================================
class Viewport
  #--------------------------------------------------------------------------
  # * Set Selection W && H
  #--------------------------------------------------------------------------
  def set_case(w,h)
    @selection_zone_w = w
    @selection_zone_h = h
    @column = self.rect.width / w
    @line = self.rect.height / h
    p w
    p h
    p @column
    p @line
  end
  #--------------------------------------------------------------------------
  # * Get Coord
  #--------------------------------------------------------------------------
  def coord 
    x = (Mouse.x - self.rect.x) / @selection_zone_w
    y = (Mouse.y - self.rect.y) / @selection_zone_h 
    [x,y]
  end
  #--------------------------------------------------------------------------
  # * Coord to ID
  #--------------------------------------------------------------------------
  def coord_to_id(x,y)
   @column * y + x
  end
  #--------------------------------------------------------------------------
  # * Get ID
  #-------------------------------------------------------------------------- 
  def id
    coord_to_id(*coord)
  end
  #--------------------------------------------------------------------------
  # * ID to Coord
  #-------------------------------------------------------------------------- 
  def id_to_coord(id)
    x = id % @column
    y = id / @column
    [x,y]
  end
end
#==============================================================================
# ** Scrollable_Viewport
#------------------------------------------------------------------------------
# 
#==============================================================================
module GUI
  class Scrollable_Viewport < ::Viewport
    #--------------------------------------------------------------------------
    # * Get Coord 
    #--------------------------------------------------------------------------
    def coord
      v_index = self.vertical.index == 0 ? 1 : self.vertical.index
      h_index = self.horizontal.index == 0 ? 1 : self.horizontal.index
      x = (self.calc_width*h_index/self.horizontal.max + Mouse.x - self.rect.x) / @selection_zone_w
      y = (self.calc_height*v_index/self.vertical.max + Mouse.y - self.rect.y) / @selection_zone_h
      [x,y]
    end
  end
end
